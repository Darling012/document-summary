# 关于实体状态的设计

## 问题
1. 是将所有状态放在一个字段里，还是多个字段，判断依据是什么？
	1. 感觉判断是否为一组状态依据是，后续动作会不会对之前状态有影响。有那么这个动作产生的状态就与之前的是一组。比如订单中的是否评论，评论动作不会对订单状态有影响，所以可以单独一个状态字段。
2. 需要定义哪些状态？
3. 什么情况下需要按状态分表？
4. 状态字段如何表示？
	1. 状态值有状态情况下怎么应对新增状态情况？


##### 怎么选择定义哪些状态？
核心业务流程

##### 一个字段还是多个字段
1. 一个字段里的状态，要符合状态机设计原则（任何时刻，事物总是处于一种状态）
	1. 假如状态存在同时共存情况，那肯定多个字段。
	2. 状态不会共存，是串行的，那就一个，状态回溯清晰。
2. 优化统计，比如对状态范围统计，可以新增状态字段。比如未处理（未下发、超期）、处理（打分中、超时、完成）

##### 有无必要按状态分表
1. 感觉除非有效率考虑，或者隔离复杂度。比如处理中的任务要频繁更新，对任务表原有表操作造成影响。锁影响？
2. 

##### 状态用什么形式及类型表示
1. 单个字段用位标识状态适合多种类型，每种类型只有两个状态。比如是否支持支付宝、微信、云闪付等就可以用 101=5 表示支持支付宝、云闪付，不支持微信
2. [爆栈思想 – 数据库“状态”字段如何设计 – 爆栈网 – 开发人员的爆栈之旅](https://kayow.com/2018/07/how_do_design_a_status_column/)
3. [Mysql数据库表字段设计优化（状态列）-阿里云开发者社区](https://developer.aliyun.com/article/1094043)
4. 用时间字段，比如订单创建时间有无值来判断是否处于这一状态

##### reference
1.  [php - Mysql关于表的状态字段设计 - SegmentFault 思否](https://segmentfault.com/q/1010000040920065)
2.  [数据库设计中“多选状态标识”的处理_生有涯，知无涯的博客-CSDN博客_多选状态 “位”表示](https://blog.csdn.net/qq_38923792/article/details/100299368)
3.  [后端 - 数据库状态字段设计的问题 - SegmentFault 思否](https://segmentfault.com/q/1010000041082532)
	1. 不要寄希望于一个设计解决很多事情，这样只会造成边界混乱
4.  [关于数据库‘状态’字段设计的思考与实践 - 倒骑的驴 - 博客园](https://www.cnblogs.com/daoqidelv/p/7384648.html)
	1. 对于‘已评论’、‘已退货’这类状态是放到‘订单状态’中？还是独立一个字段标识？
	2. 订单表的‘订单状态’字段对应的字典值如何表示？
	3. 订单表的‘订单状态’字段使用何种类型？可选项有：number(N)、char(N)、varchar2(N);
